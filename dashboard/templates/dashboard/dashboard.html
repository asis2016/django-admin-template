{% extends 'base.html' %}

{% block main_content %}
<!-- page title -->
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 pageTitle">
    <h3>Dashboard</h3>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
            <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
        </div>
        <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
            <span data-feather="calendar"></span>
            This week
        </button>
    </div>
</div>
<!-- page title ends -->

<!-- row for cardQuickInfo -->
<div class="row mt-4">
    {% for i in quick_info_data %}
    <div class="col-lg-3">
        <div class="card cardQuickInfo">
            <div class="card-body">
                <div>
                    <h3>{{ i.title }}</h3>
                    <p>{{ i.description }}</p>
                </div>
                <div>
                    {{ i.icon|safe }}
                </div>
            </div>
            <div class="card-footer text-center">
                <a href="#">
                    Read more <i class="bi bi-arrow-right-circle"></i>
                </a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
<!-- row for cardQuickInfo ends -->

<!-- row for orderStatus -->
<div class="row mt-4">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Order Status</h4>
                <table class="table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Client</th>
                            <th>Order no</th>
                            <th>Product</th>
                            <th>Selling price</th>
                            <th>Payment mode</th>
                            <th>Date</th>
                            <th>Payment status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for i in order_status %}
                        <tr>
                            <td>
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                            </td>
                            <td class="d-flex align-items-center">
                                <span class="nameInitial">{{ i.client_initial}}</span>&nbsp;&nbsp;{{ i.client_name }}
                            </td>
                            <td>{{ i.order_no }} </td>
                            <td>{{ i.product_title }} </td>
                            <td>{{ i.product_price }} </td>
                            <td>{{ i.payment_mode }} </td>
                            <td>{{ i.date }} </td>
                            <td>{{ i.payment_status|safe }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- row -->
<div class="row mt-4">
    <div class="col-lg-8"></div>

    <!-- Visitors' Browser -->
    <div class="col-lg-4">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Visitors' Browser</h4>
                <div class="d-flex justify-content-center">
                    <canvas id="visitorBrowser" style="height: 300; width: 300;"></canvas>
                </div>
                <!-- table  -->
                <table class="table table-responsive mt-4">
                    {% for i in vistors_browser %}
                    <tr>
                        <td>
                            <i class="bi bi-circle-fill bg-dark" style="color: {{ i.color }};"></i>
                            &nbsp;&nbsp;{{i.browser }}
                        </td>
                        <td>
                            {{ i.visits }}%
                        </td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock main_content %}

<!-- footer -->
{% block footer %}
<script>
    const ctx = document.getElementById('visitorBrowser');

    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Safari', 'Chrome', 'IE', 'Opera', 'Firefox', 'Others'],
            datasets: [{
                data: [10, 20, 20, 5, 42, 3],
                borderWidth: 1,
                backgroundColor: ['red', 'yellow', 'green', 'purple', 'orange', 'indigo']
            }]
        },
        options: {
            plugins: {
                legend: {
                    display: false  // Hide the legend
                },
                tooltip: {
                    callbacks: {
                        label: function (context) {
                            // Calculate the percentage and display it in the tooltip
                            let dataSum = context.dataset.data.reduce((accumulator, currentValue) => accumulator + currentValue, 0);
                            let currentValue = context.dataset.data[context.dataIndex];
                            let percentage = ((currentValue / dataSum) * 100).toFixed(2) + "%";
                            return percentage;
                        }
                    }
                }
            },
            scales: {
                x: {
                    display: false  // Hide x-axis
                },
                y: {
                    display: false  // Hide y-axis
                }
            },
            layout: {
                padding: {
                    left: 0,
                    right: 0,
                    top: 0,
                    bottom: 0
                }
            },
            responsive: false,
            height: 250, // Set the desired height
            width: 250 // Set the desired width
        }
    });
</script>
{% endblock footer %}